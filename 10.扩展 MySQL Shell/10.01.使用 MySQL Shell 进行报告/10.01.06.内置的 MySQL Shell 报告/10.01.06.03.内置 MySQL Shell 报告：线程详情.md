#### 10.1.6.3 内置 MySQL Shell 报告：线程详情

内置的 MySQL Shell 报告 `thread` 从 MySQL Shell 8.0.18 版本开始提供。它提供了连接到的 MySQL 服务器中某个特定线程的详细信息。该报告适用于运行所有支持的 MySQL 5.7 和 MySQL 8.0 版本的服务器。如果目标服务器的 MySQL 服务器版本中某项信息不可用，报告将省略该信息。

`thread` 报告提供了所选线程及其活动的信息，这些信息来自包括 MySQL 的性能模式（Performance Schema）在内的各种来源。默认情况下，报告显示当前连接使用的线程的信息，或者您可以通过其 ID 或连接 ID 来标识线程。您可以选择一个或多个信息类别，或查看有关线程的所有可用信息。有关特定于报告的选项的详细信息以及您可以包含在报告中的信息，请发出以下 MySQL Shell 命令之一以查看报告帮助：

```
\help thread
\show thread --help
```

除了特定于报告的选项外，`thread` 报告接受大多数 `\show` 和 `\watch` 命令的标准选项，如第 10.1.5 节 “运行 MySQL Shell 报告” 中所述。例外是 `\show` 命令的 `--vertical`（或 `-E`）选项，不被接受。`thread` 报告具有自定义的输出格式，包括在不同部分呈现的垂直列表和表格，您不能更改此输出格式。

`threads` 报告使用 MySQL 服务器的 `format_statement()` 函数（参见 `format_statement()` 函数）。报告中显示的任何截断语句都根据 MySQL 服务器 `sys_config` 表中的 `statement_truncate_len` 选项设置进行截断，默认为 64 个字符。

以下列表总结了 `threads` 报告特定选项提供的功能。请查看报告帮助以获取完整的详细信息和选项的简写形式：

- `--tid`, `--cid`
  标识您要报告的线程 ID 或连接 ID。

- `--general`
  显示有关线程的基本信息。如果您不使用以下任何选项，默认返回此信息。

- `--brief`
  以一行显示线程的简要描述。

- `--client`
  显示有关客户端连接和客户端会话的信息。

- `--innodb`
  显示线程使用的当前 InnoDB 事务的信息（如果有）。

- `--locks`
  显示有关线程阻塞和被阻塞的锁的信息。

- `--prep-stmts`
  显示为线程分配的预处理语句的信息。

- `--status`
  显示线程的会话状态变量的信息。您可以指定一系列前缀来匹配，这种情况下只显示匹配的变量。

- `--vars`
  显示线程的会话系统变量的信息。您可以指定一系列前缀来匹配，这种情况下只显示匹配的变量。

- `--user-vars`
  显示线程的用户定义变量的信息。您可以指定一系列前缀来匹配，这种情况下只显示匹配的变量。

- `--all`
  显示上述所有信息，除了简要描述。

例如，以下命令运行线程 ID 为 53 的线程的 `thread` 报告，并返回有关线程的一般信息、客户端连接的详情以及线程阻塞或被阻塞的锁的信息：

```
mysql-py>  \show thread --tid 53 --general --client --locks
```