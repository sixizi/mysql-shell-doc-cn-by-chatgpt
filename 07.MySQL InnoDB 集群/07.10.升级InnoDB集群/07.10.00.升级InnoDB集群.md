## 7.10 升级InnoDB Cluster

- [7.10.1 InnoDB Cluster升级](./07.10.01.InnoDB Cluster升级.md)
- [7.10.2 InnoDB Cluster升级故障排除](./07.10.02.InnoDB Cluster升级故障排除.md)

本节解释了如何升级您的集群。InnoDB Cluster升级过程的很大一部分包括以与升级Group Replication文档中相同的方式升级实例。本节重点介绍升级InnoDB Cluster的额外考虑事项。在开始升级之前，您可以使用MySQL Shell第11.1节，“升级检查器工具”来验证实例是否准备好进行升级。

> **重要**
>
> 由于元数据查询中的一个错误，MySQL Shell 8.0.27无法用于管理运行MySQL Server 8.0.25的InnoDB Cluster。要解决这个问题，在使用MySQL Shell 8.0.27与集群一起之前，请先将InnoDB Cluster成员实例上的MySQL Server升级到8.0.26或8.0.27版本。该问题将在MySQL Shell 8.0.28中修复。

从版本8.0.19开始，如果您尝试对集群进行MySQL Router引导，并且发现元数据版本为0.0.0，这表示元数据升级正在进行中，引导将失败。等待元数据升级完成后再尝试再次引导。当MySQL Router正常运行（不是引导状态）并且发现元数据版本为0.0.0（升级进行中）时，MySQL Router不会继续刷新它即将开始的元数据。相反，MySQL Router继续使用它缓存的最后元数据。所有现有用户连接都被保持，任何新连接都根据缓存的元数据进行路由。当元数据版本不再为0.0.0时，元数据刷新重启。在常规（非引导）模式下，MySQL Router与版本为1.x.x和2.x.x的元数据一起工作。版本可以在TTL刷新之间更改。这一更改确保了您在升级集群时路由继续进行。

虽然集群中的实例可以运行多个MySQL版本，例如，版本5.7和8.0，但不建议长时间使用这种混合。例如，在使用不同版本的集群中，运行版本5.7的实例离开集群，然后使用MySQL Clone进行恢复操作，运行较低版本的实例无法再加入集群，因为BACKUP_ADMIN权限成为要求。运行多个版本的集群是作为从一个版本迁移到另一个版本的临时情况，并不适合长期使用。